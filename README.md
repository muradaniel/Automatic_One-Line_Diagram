# [Automatic One-Line Diagram](https://www.google.com/?hl=pt-BR)  
<details>
  <summary>***Context***</summary>
During an Electrical Engineering course, we were tasked with developing a tool to perform short-circuit calculations in electric power systems, similar to the Anafas simulator. The method used relied on Excel spreadsheets as data input, registering buses, transmission lines, transformers, and shunt loads.

After reading the elements and performing short-circuit calculations, as well as computing bus voltages and branch currents, I noticed an important limitation: inputting data solely through tables made system visualization very abstract. This increased the chances of typing errors and incorrect connections — especially in systems with a large number of buses and connected equipment.

To address this, I found the Schemdraw library in Python, which has excellent documentation and allows for the creation of high-quality electrical and electronic circuits, block diagrams, flowcharts, and technical drawings, exportable in various formats (PDF, PNG, JPEG, etc.).

The idea, then, was to use Python to read the system data from spreadsheets and automatically generate the corresponding one-line diagram in an organized and connected manner. The greatest challenge was organizing the elements visually, especially to avoid overlapping or intersecting connections.

To solve this, I applied graph theory concepts with the help of the NetworkX library, which allowed for a clean and understandable circuit layout. Since Schemdraw is not specifically tailored to power systems, I developed custom elements such as bus symbols, two- and three-winding transformers, and a short-circuit symbol.

With the diagram foundation ready, I moved on to the customization stage: coloring elements according to their voltage levels, adding margins and a legend — similar to what is seen in technical drawings — and including key short-circuit information at the faulted bus.

Besides enriching visualization and making simulated systems easier to interpret, this tool can be especially useful when used alongside simulators that don’t have an integrated one-line diagram, such as Simulight and Anatem. It provides a complementary visual interface that improves the reliability and understanding of the results.

Finally, I include some diagrams generated by the application as examples, and I thank Rafael de Castro Roque and Gabriel Bié da Fonseca for their valuable feedback and constructive suggestions throughout the development of this project. The tool is available on my GitHub and website.

References:  
https://schemdraw.readthedocs.io/en/stable/  
https://networkx.org/documentation/stable/  
https://pandas.pydata.org/docs/

---

## How to Use  
There are several parameters that can be configured to generate the diagram in the desired format. These include:  

- Around line 65:  
```python  
posicao_elementos = nx.spring_layout(G, scale=8, iterations=300000, threshold=1e-10)
```

***nx.spring_layout*** — Graph layout model, options:  
- `spring_layout` → spring model  
- `circular_layout` → arranged in a circle  
- `shell_layout` → concentric layers  
- `kamada_kawai_layout` → distance-preserving  
- `random_layout` → random positions  
- `spectral_layout` → based on eigenvalues  
- `planar_layout` → no crossings (planar graph)  
- `spiral_layout` → spiral arrangement  
- `bipartite_layout(G, nodes)` → two groups (bipartite)

***scale*** — spacing between graph vertices (elements), any number greater than zero.  

***iterations*** — basically the number of times the layout algorithm attempts to optimize element positions.  


- Around line 71:  
```python
cores_tensoes = sns.color_palette("tab10", len(niveis_de_tensoes))
```
This line automatically generates colors, but the color palette can be changed.  
Options:  
| Palette         | Keyword                  |  
| --------------- | ------------------------ |  
| `"deep"`        | **Elegant default**      |  
| `"muted"`       | **Soft**                 |  
| `"bright"`      | **Vibrant**              |  
| `"pastel"`      | **Light/Soft**           |  
| `"dark"`        | **Dark**                 |  
| `"colorblind"`  | **Accessible**           |  
| `"tab10"`       | **Classic**              |  
| `"Set1"`        | **Bold**                 |  
| `"Set2"`        | **Moderate**             |  
| `"Set3"`        | **Varied**               |  
| `"Paired"`      | **Contrasting pairs**    |  


- Around line 148:  
```python
posicao_elementos[key][0] *= 8
posicao_elementos[key][1] *= 6
```
These numbers can be adjusted to achieve a better X/Y ratio, depending on whether you plan to print, the size of the screen, etc.


- Around line 296:  
```python
d.config(fontsize=7)
```
Adjusts the font size of the element labels in the diagram.

![Diagrama Unifilar](images/short_circuit_symbol.png)

