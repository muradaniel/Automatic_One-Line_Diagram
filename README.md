# [Automatic One-Line Diagram](https://www.google.com/?hl=pt-BR)

<details>
  <summary>Context</summary>

During an Electrical Engineering course, we were tasked with developing a tool to perform short-circuit calculations in electric power systems, similar to the Anafas simulator. The method used relied on Excel spreadsheets as data input, registering buses, transmission lines, transformers, and shunt loads.

After reading the elements and performing short-circuit calculations, as well as computing bus voltages and branch currents, I noticed an important limitation: inputting data solely through tables made system visualization very abstract. This increased the chances of typing errors and incorrect connections ‚Äî especially in systems with a large number of buses and connected equipment.

To address this, I found the **Schemdraw** library in Python, which has excellent documentation and allows for the creation of high-quality electrical and electronic circuits, block diagrams, flowcharts, and technical drawings, exportable in various formats (PDF, PNG, JPEG, etc.).

The idea, then, was to use Python to read the system data from spreadsheets and automatically generate the corresponding one-line diagram in an organized and connected manner. The greatest challenge was organizing the elements visually, especially to avoid overlapping or intersecting connections.

To solve this, I applied **graph theory** concepts with the help of the **NetworkX** library, which allowed for a clean and understandable circuit layout. Since Schemdraw is not specifically tailored to power systems, I developed custom elements such as bus symbols, two- and three-winding transformers, and a short-circuit symbol.

With the diagram foundation ready, I moved on to the customization stage: coloring elements according to their voltage levels, adding margins and a legend ‚Äî similar to what is seen in technical drawings ‚Äî and including key short-circuit information at the faulted bus.

Besides enriching visualization and making simulated systems easier to interpret, this tool can be especially useful when used alongside simulators that don‚Äôt have an integrated one-line diagram, such as Simulight and Anatem. It provides a complementary visual interface that improves the reliability and understanding of the results.

Finally, I include some diagrams generated by the application as examples, and I thank **Rafael de Castro Roque** and **Gabriel Bi√© da Fonseca** for their valuable feedback and constructive suggestions throughout the development of this project. The tool is available on my GitHub and website.

**References**:  
üìö https://schemdraw.readthedocs.io/en/stable/  
üîó https://networkx.org/documentation/stable/  
üêº https://pandas.pydata.org/docs/

</details>

---

<details>
  <summary>Customization</summary>

There are several parameters that can be configured to generate the diagram in the desired format. These include:  


### Graph Layout

> Around line 65:

```python
posicao_elementos = nx.spring_layout(G, scale=70, iterations=300000, threshold=1e-9)
```
Here you can change 2 parameters, layout and/or scale.

- **Layout**  

| Layout                        | Description                      |
|------------------------------|----------------------------------|
| `nx.spring_layout`           | **Spring model**                 |
| `nx.circular_layout`         | **Arranged in a circle**         |
| `nx.shell_layout`            | **Concentric layers**            |
| `nx.kamada_kawai_layout`     | **Distance-preserving**          |
| `nx.random_layout`           | **Random positions**             |
| `nx.spectral_layout`         | **Based on eigenvalues**         |
| `nx.planar_layout`           | **No crossings (planar graph)**  |
| `nx.spiral_layout`           | **Spiral arrangement**           |
| `nx.bipartite_layout(G, nodes)` | **Two groups (bipartite)**    |

- **scale** ‚Äî spacing between graph vertices. Any number > 0.  

- **iterations** ‚Äî spacing between graph vertices. Any number > 0.  

- **threshold** ‚Äî spacing between graph vertices. Any number > 0. 

---

### üé® Color Palette

> Around line 71:

```python
cores_tensoes = sns.color_palette("tab10", len(niveis_de_tensoes))
```

| Palette         | Description               |
|----------------|---------------------------|
| `"deep"`        | **Elegant default**       |
| `"muted"`       | **Soft**                  |
| `"bright"`      | **Vibrant**               |
| `"pastel"`      | **Light/Soft**            |
| `"dark"`        | **Dark**                  |
| `"colorblind"`  | **Accessible**            |
| `"tab10"`       | **Classic**               |
| `"Set1"`        | **Bold**                  |
| `"Set2"`        | **Moderate**              |
| `"Set3"`        | **Varied**                |
| `"Paired"`      | **Contrasting pairs**     |

---

### Font Size

> Around line 296:

```python
d.config(fontsize=7)
```

Sets the font size for the labels.

</details>
<details>
  <summary>How to Use</summary>
Para usar √© necess√°rio seguir alguns passos e tomar alguns cuidados ao longo do processo para evitar erros.
- Preechimento da planilha excel *registration_elements.xlsx*
Nessa planilha √© a base de daddos da ferramenta desenvolvida, ou seja, √© nela que voc√™ ir√° cadastrar os elementos do sistema el√©trico de pot√™ncia sendo eles: Barramentos, Linhas de Trnasmiss√£o, Cargas Shunts, Geradores, e transformadores de 2 e 3 enrolamentos.

Cada tipo de elemento est√° separado em cada planilha, sendo neces√°rio o preenchimento de dados em todas as colunas.

Outro ponto super imporante √©: Cada elemento deve ter um nome diferente, o nomne do elemento √© an√°logo as seu 'ID' caso seja preenchido valores iguais haver√° superposi√ß√£o!!! por exemplo seu sistema h√° 1 linha de transmiss√£o chamada "L1" e uma carga shunt chamada tamb√©m "L1" quando rodar a simu√ß√£o ela n√£o retornar√° erros, porem esses elementos ir√£o compartilhar a mesmna poosi√ß√£o, ficando sbrepostos e bagun√ßando o toodo o diagrama.

Outro ponto importante condiz com as cores do diagrama a base lida dos n√≠veis de tens√£o est√£o continas na planilha de barras, ou seja, caso algum elemento use algum n√≠vel de tens√£o que n√£o esteja na planilha "barra" n√£o ficar√° colorido podendo gerar algum tipo de erro, sendo recomendado evitar.